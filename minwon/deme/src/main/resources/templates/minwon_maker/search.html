<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>민원 작성</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/css/minwon_maker/search.css">
</head>
<body>
  <div class="wrap">
    <h1>민원 작성</h1>

    <!-- 검색 -->
    <form class="search-bar" id="search-form" role="search" aria-label="민원 검색">
      <input id="search-input" type="search" placeholder="원하는 민원명을 입력하세요 (예: 전입신고, 등본, 여권 재발급)" autocomplete="off" />
      <button type="submit" class="btn primary">검색</button>
    </form>

    <!-- 자주찾는 민원 -->
    <section class="section">
      <h2>자주찾는 민원</h2>
      <div class="quick-grid">
        <a class="quick-btn"      href="/minwon/residentregistration">주민등록등본</a>
        <a class="quick-btn--alt quick-btn" href="/minwon/residentregistration">주민등록초본</a>
        <a class="quick-btn"      href="/minwon/move/transfer">전입신고</a>
        <a class="quick-btn--alt quick-btn" href="/minwon/certificates/family">가족관계증명서</a>
        <a class="quick-btn"      href="/minwon/passport/reissue">여권 재발급</a>
        <a class="quick-btn--alt quick-btn" href="/minwon/id/reissue">주민등록증 재발급</a>
      </div>
    </section>

    <!-- 툴바 (표시개수/정렬) -->
    <div class="toolbar">
      <div class="tool-left">
        <label for="page-size" class="sr-only">표시 개수</label>
        <select id="page-size" class="select">
          <option value="10">10개씩 보기</option>
          <option value="20">20개씩 보기</option>
          <option value="50">50개씩 보기</option>
        </select>

        <label for="sort-by" class="sr-only">정렬</label>
        <select id="sort-by" class="select">
          <option value="latest">최신순</option>
          <option value="name">이름순</option>
        </select>
      </div>
      <div class="tool-right">
        <span id="result-count" class="count">총 0건</span>
      </div>
    </div>

    <!-- 목록 -->
    <div id="list" class="list" role="list"></div>

    <!-- 페이지네이션 -->
    <div class="pager">
      <button id="prev" class="btn" type="button">이전</button>
      <span id="page-info" class="page-info">1 / 1</span>
      <button id="next" class="btn" type="button">다음</button>
    </div>
  </div>

  <script>
    // ===== 샘플 데이터 (여기에 실제 민원 항목을 연결하세요) =====
    // createdAt은 최신순 정렬용 (YYYY-MM-DD)
    const SERVICES = [
      { id: 'resident-copy',        name: '주민등록등본 발급',              href: '/minwon/certificates/resident-copy',        tag:'등본',       createdAt:'2025-09-01' },
      { id: 'resident-abstract',    name: '주민등록초본 발급',              href: '/minwon/certificates/resident-abstract',    tag:'초본',       createdAt:'2025-08-28' },
      { id: 'move-transfer',        name: '전입신고',                      href: '/minwon/move/transfer',                     tag:'전입',       createdAt:'2025-08-20' },
      { id: 'family-cert',          name: '가족관계증명서 발급',            href: '/minwon/certificates/family',               tag:'가족',       createdAt:'2025-08-18' },
      { id: 'passport-reissue',     name: '여권 재발급 신청',               href: '/minwon/passport/reissue',                  tag:'여권',       createdAt:'2025-08-15' },
      { id: 'id-reissue',           name: '주민등록증 재발급',              href: '/minwon/id/reissue',                        tag:'신분증',     createdAt:'2025-08-10' },
      { id: 'seal-cert',            name: '인감증명서 발급',                href: '/minwon/certificates/seal',                 tag:'인감',       createdAt:'2025-08-02' },
      { id: 'birth-report',         name: '출생신고',                      href: '/minwon/life/birth',                        tag:'출생',       createdAt:'2025-07-29' },
      { id: 'marriage-report',      name: '혼인신고',                      href: '/minwon/life/marriage',                     tag:'혼인',       createdAt:'2025-07-20' },
      { id: 'death-report',         name: '사망신고',                      href: '/minwon/life/death',                        tag:'사망',       createdAt:'2025-07-16' },
      { id: 'driver-change',        name: '운전면허 주소변경',               href: '/minwon/driver/address',                    tag:'운전면허',   createdAt:'2025-07-10' },
      { id: 'vehicle-reg',          name: '자동차 등록증 재발급',            href: '/minwon/vehicle/registration',              tag:'자동차',     createdAt:'2025-07-05' },
      { id: 'tax-certificate',      name: '지방세 납세증명서 발급',          href: '/minwon/tax/local',                         tag:'세금',       createdAt:'2025-06-30' },
      { id: 'health-cert',          name: '건강보험 자격득실 확인서',         href: '/minwon/nhis/eligibility',                  tag:'건강보험',   createdAt:'2025-06-18' },
      { id: 'employment-cert',      name: '고용보험 자격이력 내역서',         href: '/minwon/moel/employment',                   tag:'고용',       createdAt:'2025-06-10' },
      { id: 'biz-reg',              name: '사업자등록증명',                  href: '/minwon/nts/biz',                           tag:'사업자',     createdAt:'2025-06-02' },
      { id: 'address-change',       name: '주소변경 통합신고',                href: '/minwon/address/change',                    tag:'주소',       createdAt:'2025-05-28' },
      { id: 'school-cert',          name: '재학(재적)증명서',                 href: '/minwon/edu/enroll',                        tag:'교육',       createdAt:'2025-05-20' },
      { id: 'scholarship',          name: '장학금 신청',                      href: '/minwon/edu/scholarship',                   tag:'교육',       createdAt:'2025-05-12' },
      { id: 'pet-reg',              name: '반려동물 등록',                    href: '/minwon/pet/registration',                  tag:'동물',       createdAt:'2025-05-01' },
      { id: 'welfare-benefit',      name: '기초생활 수급 신청',               href: '/minwon/welfare/basic',                     tag:'복지',       createdAt:'2025-04-25' },
      { id: 'parking-permit',       name: '거주자 주차 허가',                  href: '/minwon/parking/permit',                    tag:'주차',       createdAt:'2025-04-12' },
      { id: 'noise-report',         name: '층간소음 상담/민원',                href: '/minwon/environment/noise',                 tag:'환경',       createdAt:'2025-04-01' },
      { id: 'lost-report',          name: '분실물 신고',                      href: '/minwon/police/lost',                       tag:'신고',       createdAt:'2025-03-22' },
      { id: 'complaint',            name: '일반 민원 접수',                    href: '/minwon/general/complaint',                 tag:'민원',       createdAt:'2025-03-10' },
    ];

    // ===== 상태 =====
    let keyword = '';
    let pageSize = 10;
    let sortBy = 'latest'; // 'latest' | 'name'
    let page = 1;
    let filtered = [...SERVICES];

    // ===== DOM =====
    const searchForm  = document.getElementById('search-form');
    const searchInput = document.getElementById('search-input');
    const pageSizeSel = document.getElementById('page-size');
    const sortSel     = document.getElementById('sort-by');
    const listEl      = document.getElementById('list');
    const prevBtn     = document.getElementById('prev');
    const nextBtn     = document.getElementById('next');
    const pageInfo    = document.getElementById('page-info');
    const resultCount = document.getElementById('result-count');

    // ===== 유틸 =====
    const normalize = s => (s||'').toString().toLowerCase().trim();
    const compareLatest = (a,b) => (b.createdAt?.localeCompare(a.createdAt||'')||0);
    const compareName   = (a,b) => a.name.localeCompare(b.name,'ko');

    function applyFilter(){
      const k = normalize(keyword);
      filtered = SERVICES.filter(s => {
        if(!k) return true;
        return normalize(s.name).includes(k) || normalize(s.tag).includes(k);
      });

      // 정렬
      filtered.sort(sortBy === 'name' ? compareName : compareLatest);

      // 첫 페이지로
      page = 1;
      render();
    }

    function paginate(arr, page, pageSize){
      const start = (page-1)*pageSize;
      return arr.slice(start, start+pageSize);
    }

    function render(){
      // 카운트/페이지 계산
      const total = filtered.length;
      const totalPages = Math.max(1, Math.ceil(total / pageSize));
      if(page > totalPages) page = totalPages;

      resultCount.textContent = `총 ${total}건`;
      pageInfo.textContent = `${page} / ${totalPages}`;

      prevBtn.disabled = (page<=1);
      nextBtn.disabled = (page>=totalPages);

      // 목록 렌더
      const view = paginate(filtered, page, pageSize);
      listEl.innerHTML = view.map(item => `
        <div class="item" role="listitem">
          <div class="item-col--grow">
            <div class="item-title">${item.name}</div>
            <div class="item-sub">분류: <span class="badge">${item.tag}</span> · 등록일: ${item.createdAt}</div>
          </div>
          <a class="btn primary" href="${item.href}">작성하기</a>
        </div>
      `).join('') || `
        <div class="item"><div class="item-col--grow">검색 결과가 없습니다.</div></div>
      `;
    }

    // ===== 이벤트 =====
    searchForm.addEventListener('submit', (e) => {
      e.preventDefault();
      keyword = searchInput.value;
      applyFilter();
    });

    pageSizeSel.addEventListener('change', e => {
      pageSize = parseInt(e.target.value,10) || 10;
      render();
    });

    sortSel.addEventListener('change', e => {
      sortBy = e.target.value;
      applyFilter();
    });

    prevBtn.addEventListener('click', () => { if(page>1){ page--; render(); } });
    nextBtn.addEventListener('click', () => { const totalPages = Math.max(1, Math.ceil(filtered.length / pageSize)); if(page<totalPages){ page++; render(); } });

    // 초기 상태
    render();
  </script>
</body>
</html>
