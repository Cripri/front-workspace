<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #box2, #box2 div, [id^="box3"],[id^="box4"]{
            padding: 0 15px;
            border: solid 3px black;
            min-height: 100px;
            background-color: white;
            margin: 15px 0;
        }

        .wrapper{
            padding: 15px;
            margin: 15px 0;
            border: solid 3px black;
        }
    </style>
</head>
<body>

    <h3># 이벤트 위임 현상</h3>

    <ul>
        <li>기본적으로 부모 요소에서 추가한 이벤트는 그 위에 놓여있는 자식 요소에서도 발동한다</li>
        <li>이벤트를 발생시킨 객체의 인스턴스가 이벤트 객체의 target에 실려온다</li>
    </ul>
    
    <div id="box2">
        <div>
            <div>
                <div>
                    <div></div>
                </div>
            </div>
        </div>
    </div>

    <h3># 이벤트 버블링</h3>

    <ul>
        <li>중첩된 요소에서 이벤트가 발생했을때 해당 이벤트가
            자식요서에서부터 부모 요소까지 전이되는 현상</li>
        <li>target과 currentTarget을 사용해 이벤트 버블링 도중에
            발생시키고 싶은 이벤트만 골라낼 수 있다</li>
        
    </ul>

    <div id="box3">
        <div id="box3-1">
            <div id="box3-1-1"></div>
        </div>
    </div>

    <h3># 이벤트 캡처링</h3>

    <ul>
        <li>버블링보다 먼저 일어나는 이벤트 처리 단계</li>
        <li>버블링과는 반대로 부모 요소부터 자식 요소까지 전이되는 이벤트 처리 순서</li>
        <li>기본적으로는 비활성화 되어있다</li>
        <li>캡처링이 모두 진행되고 난 후에는 원래대로 버블링이 진행된다</li>
    </ul>

    <div id="box4">
        <div id="box4-1">
            <div id="box4-1-1"></div>
            <div id="box4-1-2"></div>
        </div>
        <div id="box4-2"></div>
    </div>

    <h3># 요소의 기본 동작 막기</h3>

    <ul>
        <li>어떤 요소들은 이벤트 발생전에 실행되는 기본 동작들이 있다</li>
        <li>원하는 이벤트를 처리하기 위해 기본 동작을 막아야 하는 경우들이 있다</li>
        <li>이벤트 객체의 preventDefault()를 실행하여 막는다</li>
    </ul>

    <div class="wrapper">
        <div>아이디를 입력하세요. 영어 소문자와 숫자만 사용할 수 있습니다</div>
        <input type="text" id="id-text-input">
    </div>

    
    <script>
        const box2 = document.getElementById('box2');

        box2.addEventListener('click', (e) => {
            console.dir(e);

            // target: 이벤트가 발동한 객체
            e.target.style.backgroundColor = 'violet';
        });

        const box3 = document.getElementById('box3');
        const box3_1 = document.getElementById('box3-1');
        const box3_1_1 = document.getElementById('box3-1-1');

        box3.addEventListener('click', e =>{
            // 이 이벤트를 발생시킨 곳: target
            // 이 이벤트가 달려있는 곳: currentTarget
            if(e.currentTarget != e.target){
                return;
            }

            // window.alert('제일 바깥쪽 박스가 클릭됨')
            console.log('alert:','제일 바깥쪽 박스가 클릭됨');
            console.log('target:', e.target);
            console.dir(e);
            e.target.style.backgroundColor = 'green';
        });

        box3_1.addEventListener('click', e =>{
            // window.alert('중간 박스가 클릭됨');
            console.log('alert:','중간 박스가 클릭됨');
            console.log('target:', e.target);
            console.dir(e);
            e.target.style.backgroundColor = 'orange';
        });

        box3_1_1.addEventListener('click', e =>{
            // window.alert('제일 안쪽 요소가 클릭됨');
            console.log('alert:','제일 안쪽 박스가 클릭됨');
            console.log('target:', e.target);
            console.dir(e);
            e.target.style.backgroundColor = 'red';
        });

        const box4 = document.getElementById('box4');
        const box4_1 = document.getElementById('box4-1');
        const box4_1_1 = document.getElementById('box4-1-1');
        const box4_1_2 = document.getElementById('box4-1-2');
        const box4_2 = document.getElementById('box4-2');

        // addEventListener의 3번쨰 파라미터를 true로 설정하면
        // 캡처링 단계에서 해당 이벤트를 발생시키겠다고 설정하는 것
        box4.addEventListener('click', e => {
            console.log('capture box4:', e);
            // console.log('target:', e.target);
            // console.log('currenttarget:', e.currentTarget);
            //console.dir(e);
        }, true);

        box4_1.addEventListener('click', e => {
            console.log('capture box4_1:', e);
            // console.log('target:', e.target);
            // console.log('currenttarget:', e.currentTarget);
            //console.dir(e);
        }, true);

        box4_1_1.addEventListener('click', e => {
            console.log('capture box4_1_1:', e);
            // console.log('target:', e.target);
            // console.log('currenttarget:', e.currentTarget);
            //console.dir(e);
        }, true);

        box4_1_2.addEventListener('click', e => {
            console.log('capture box4_1_2:', e);
            // console.log('target:', e.target);
            // console.log('currenttarget:', e.currentTarget);
            //console.dir(e);
        }, true);

        box4_2.addEventListener('click', e => {
            console.log('capture box4_2:', e);
            // console.log('target:', e.target);
            // console.log('currenttarget:', e.currentTarget);
            //console.dir(e);
        }, true);

        // 버블링단계어서 발생시킬 이벤트를 설정
        box4.addEventListener('click', e =>{
            console.log('bubble box4:', e);
            // console.log('target:', e.target);
            // console.log('currenttarget:', e.currentTarget);
        });

        box4_1.addEventListener('click', e => {
            console.log('bubble box4_1:', e);
            // console.log('target:', e.target);
            // console.log('currenttarget:', e.currentTarget);
            //console.dir(e);
        });

        box4_1_1.addEventListener('click', e => {
            console.log('bubble box4_1_1:', e);
            // console.log('target:', e.target);
            // console.log('currenttarget:', e.currentTarget);
            //console.dir(e);
        });

        box4_1_2.addEventListener('click', e => {
            console.log('bubble box4_1_2:', e);
            // console.log('target:', e.target);
            // console.log('currenttarget:', e.currentTarget);
            //console.dir(e);
        });

        box4_2.addEventListener('click', e => {
            console.log('bubble box4_2:', e);
            // console.log('target:', e.target);
            // console.log('currenttarget:', e.currentTarget);
            //console.dir(e);
        });

        const id_text_input = document.getElementById('id-text-input');
        
        // num.toString() : 숫자 65를 '65'로 변경
        // String.fromCharCode(num) : 숫자 65를 해당 번호 문자 'A'로 변경
        let num = 65;
        console.log(String.fromCharCode(num) === 'A');

        id_text_input.addEventListener('keypress', e =>{
            //console.log('문자코드: ', e.charCode);

            const ch = String.fromCharCode(e.charCode);
            console.log('방금 입력한것:', ch);
            if(!(ch <= '9' && ch >= '0' || ch >= 'a' && ch <= 'z')){   
                window.alert('영어 소문자 또는 숫자만 입력하셔야합니다');
                e.preventDefault();// 해당 태그의 기본 동작을 취소시키는 메서드
            }
        });

    </script>
</body>
</html>